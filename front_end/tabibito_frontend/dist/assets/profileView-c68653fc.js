import{N as e}from"./navigationBar-68b72f27.js";import"./index.esm-edc83051.js";import{a as t,_ as a,u as i,g as s,r as o,b as l,o as r,c as n,d,e as c,t as m,w as p,F as u,f as h,h as g,i as f,j as v,N as _,p as y,k as w}from"./index-4a8fe44e.js";import b from"./rightSettingView-a7d0a6b5.js";import"./ArrowForwardOutline-5449d6d4.js";var D=Object.defineProperty,C=Object.defineProperties,P=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,N=(e,t,a)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,I=(e,t)=>{for(var a in t||(t={}))x.call(t,a)&&N(e,a,t[a]);if(T)for(var a of T(t))k.call(t,a)&&N(e,a,t[a]);return e},z="https://regionlookup.googleapis.com/v1alpha:searchRegion";function S(e,a=t){var i,s=e,{method:o="post",headers:l,data:r,url:n=z}=s,d=((e,t)=>{var a={};for(var i in e)x.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&T)for(var i of T(e))t.indexOf(i)<0&&k.call(e,i)&&(a[i]=e[i]);return a})(s,["method","headers","data","url"]);return i=I({},l),l=C(i,P({"Content-Type":"application/json"})),a(I({data:r,headers:l,method:o,url:n},d))}const $=({cancel:e,viewDetail:t})=>[{title:"Travel Name",key:"travelName"},{title:"Start Date",key:"startDate"},{title:"End Date",key:"endDate"},{title:"Create Date",key:"createDate"},{title:"Paid",key:"paid",sorter:{compare:(e,t)=>e.paid-t.paid}},{title:"Cancel",key:"cancel",render:t=>v(_,{strong:!0,secondary:!0,type:"error",onClick:()=>e(t)},{default:()=>"cancel"})},{title:"View Detail",key:"viewDetail",render:e=>v(_,{strong:!0,secondary:!0,type:"info",onClick:()=>t(e)},{default:()=>"view detail"})}],A=({viewDetail:e})=>[{title:"Travel Name",key:"travelName"},{title:"Start Date",key:"startDate"},{title:"End Date",key:"endDate"},{title:"Create Date",key:"createDate"},{title:"Paid",key:"paid",sorter:{compare:(e,t)=>e.paid-t.paid}},{title:"View Detail",key:"viewDetail",render:t=>v(_,{strong:!0,secondary:!0,type:"info",onClick:()=>e(t)},{default:()=>"view detail"})}],V=({viewDetail:e})=>[{title:"Travel Name",key:"travelName"},{title:"Start Date",key:"startDate"},{title:"End Date",key:"endDate"},{title:"Create Date",key:"createDate"},{title:"Paid",key:"paid",sorter:{compare:(e,t)=>e.paid-t.paid}},{title:"View Detail",key:"viewDetail",render:t=>v(_,{strong:!0,secondary:!0,type:"info",onClick:()=>e(t)},{default:()=>"view detail"})}],j={name:"profileView",components:{RightSettingView:b,NavigationBar:e},setup(){let e="en-US";"zh"===i().language&&(e="zh-CN");const t=s().appContext.config.globalProperties.axios,a=o([]);let l=o({name:"",startTime:"",endTime:"",trip_id:0,trip:[{finished:"false",title:"",content:"",day:0,time_of_day:"",time:""}]}),r=o(!1);return t.post("/user/get_user_order",{order_status:"Processing"}).then((e=>{if(200===e.status)for(const t of e.data.all_orders)a.value.push({id:t.id,travelName:t.name,startDate:t.start_time,endDate:t.end_time,createDate:t.res_time,paid:(t.price*t.discount).toFixed(2)})})),{mapLanguage:e,inProgressData:a,showModal:r,modalData:l,tabValue:o("Dashboard"),dashboardValue:o("Recent Trips"),orderType:o("In Progress"),inProgressColumns:$({cancel(e){t.post("/staff_portal/product_status?apifoxApiId=75345235",{id:e.id,operation:"Cancelled"}).then((t=>{for(let i of a.value)i.id===e.id&&a.value.splice(a.value.indexOf(i),1)}))},viewDetail(e){t.post("/user/get_order_detail",{id:e.id}).then((e=>{200===e.status&&(l.value=e.data)})),r.value=!0}}),completedColumns:A({viewDetail(e){t.post("/user/get_order_detail",{id:e.id}).then((e=>{200===e.status&&(l.value=e.data)})),r.value=!0}}),cancelledColumns:V({viewDetail(e){t.post("/user/get_order_detail",{id:e.id}).then((e=>{200===e.status&&(l.value=e.data)})),r.value=!0}})}},data:()=>({recentTrips:[],basicInfo:{},completedData:[],cancelledData:[],commentPage:o(1),commentPages:o(20),commentPageSize:o(10),commentNumber:0,comments:[],newNotices:o([]),oldNotices:o([]),footPrints:{search_values:[]}}),methods:{handleCancel(e){},initMap(){let e;S({headers:{"X-Goog-Api-Key":"AIzaSyBctzU8ocpP_0j4IdTRqA-GABIAnaXd0ow"},data:this.footPrints,withCredentials:!1}).then((t=>{let a;e=t.data.matches,a=new google.maps.Map(document.getElementById("map"),{center:{lat:20,lng:0},zoom:2,mapId:"353522139b1baa35"});let i=a.getFeatureLayer("ADMINISTRATIVE_AREA_LEVEL_1");const s={strokeColor:"#810FCB",strokeOpacity:1,strokeWeight:3,fillColor:"#810FCB",fillOpacity:.5};i.style=t=>{for(let a of e)if(t.feature.placeId===a.matchedPlaceId)return s}}))},handleChangePageSize(e){this.commentPages=Math.ceil(this.commentNumber/this.commentPageSize),this.axios.post("/comment/get_page",{page_number:this.commentPage,page_size:this.commentPageSize}).then((e=>{200===e.status&&(this.comments=e.data.comments)}))},handleChangePage(){this.axios.post("/comment/get_page",{page_number:this.commentPage,page_size:this.commentPageSize}).then((e=>{200===e.status&&(this.comments=e.data.comments)}))},handleDeleteComment(e){this.axios.post("/comment/delete",{id:e}).then((e=>{200===e.status&&this.axios.post("/comment/get_page",{page_number:this.commentPage,page_size:this.commentPageSize}).then((e=>{200===e.status&&(this.comments=e.data.comments)}))}))},handleCheck(e){this.axios.post("/user/check_notice",{id:e,new_status:"old"}).then((t=>{if(204===t.status){let t=-1;for(let a=0;a<this.newNotices.length;a++)this.newNotices[a].id===e&&(t=a);this.oldNotices.push(this.newNotices[t]),this.newNotices.splice(t,1)}}))},handleUncheck(e){this.axios.post("/user/check_notice",{id:e,new_status:"new"}).then((t=>{if(204===t.status){let t=-1;for(let a=0;a<this.oldNotices.length;a++)this.oldNotices[a].id===e&&(t=a);this.newNotices.unshift(this.oldNotices[t]),this.oldNotices.splice(t,1)}}))}},created(){this.axios.post("/user/dashboard/get_recent_trips").then((e=>{if(200===e.status){this.recentTrips=e.data.recentTrips;for(let e of this.recentTrips)this.axios.post("/third/weather",{location:e.raw_loc}).then((t=>{200===t.status&&(e.weather=t.data)})),null!==e.flight_numbers&&this.axios.post("/third/flight",{flight_numbers:e.flight_numbers}).then((t=>{200===t.status&&(e.flightInfo=t.data)}))}})),this.axios.post("/user/getprofile",{user_id:this.$route.params.uid}).then((e=>{this.basicInfo=e.data})),this.axios.post("/comment/user_all_number").then((e=>{200===e.status&&(this.commentNumber=e.data.number,this.commentPages=Math.ceil(this.commentNumber/this.commentPageSize))})),this.axios.post("/comment/get_page",{page_number:this.commentPage,page_size:this.commentPageSize}).then((e=>{200===e.status&&(this.comments=e.data.comments)})),this.axios.post("/user/get_user_order",{user_id:this.$route.params.uid,order_status:"Completed"}).then((e=>{if(200===e.status)for(const t of e.data.all_orders)this.completedData.push({id:t.id,travelName:t.name,startDate:t.start_time,endDate:t.end_time,createDate:t.res_time,paid:(t.price*t.discount).toFixed(2)})})),this.axios.post("/user/get_user_order",{user_id:this.$route.params.uid,order_status:"Cancelled"}).then((e=>{if(200===e.status)for(const t of e.data.all_orders)this.cancelledData.push({id:t.id,travelName:t.name,startDate:t.start_time,endDate:t.end_time,createDate:t.res_time,paid:(t.price*t.discount).toFixed(2)})})),this.axios.post("/user/get_notices",{status:"new"}).then((e=>{200===e.status&&(this.newNotices=e.data.notices)})),this.axios.post("/user/get_notices",{status:"old"}).then((e=>{200===e.status&&(this.oldNotices=e.data.notices)})),this.axios.get("/third/getfootprint").then((e=>{if(200===e.status)for(let t of e.data.locations)this.footPrints.search_values.push({address:t,place_type:"ADMINISTRATIVE_AREA_LEVEL_1"})}))},mounted(){let e=document.createElement("script");e.type="text/javascript",e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBctzU8ocpP_0j4IdTRqA-GABIAnaXd0ow&callback=initMap&v=beta&language="+this.mapLanguage,document.body.appendChild(e),window.initMap=this.initMap}},B=e=>(y("data-v-a7885bb9"),e=e(),w(),e),M={class:"bg"},O={class:"container"},E={class:"titlePart"},F={class:"titleMain"},U={class:"mainTitle"},L={class:"slogan"},R={class:"settings"},Y={class:"modalBody"},H={class:"orderBasic"},W={class:"attrTitle"},q={class:"attrValue"},G={class:"attrTitle"},X={class:"attrValue"},K={class:"attrTitle"},J={class:"itinerary"},Q={class:"attrTitle"},Z={class:"helloSection"},ee=["src"],te={class:"greeting"},ae={class:"recentTrip"},ie={class:"recentTripTitleBar"},se={class:"recentTripName"},oe=["onClick"],le={class:"recentTripBody"},re=["src"],ne={class:"weatherPart"},de={class:"city"},ce={class:"weatherMain"},me={class:"temperature"},pe=["src"],ue={class:"forecast"},he={class:"foreTemp"},ge={class:"tempValue"},fe={class:"tempType"},ve={class:"foreTemp"},_e={class:"tempValue"},ye={class:"tempType"},we={class:"foreTemp"},be={class:"tempValue"},De={class:"tempType"},Ce={class:"aeroPart"},Pe={class:"flightTitle"},Te={class:"flightStatus"},xe={class:"infoColumn"},ke={class:"airportNo"},Ne={class:"airportNo"},Ie={class:"infoColumn"},ze={class:"airportLoc"},Se={class:"airportLoc"},$e={class:"infoColumn"},Ae={class:"airDes"},Ve={class:"airDes"},je={class:"infoColumn"},Be={class:"airportName"},Me={class:"airportName"},Oe={class:"infoColumn"},Ee={class:"date"},Fe={class:"date"},Ue={class:"infoColumn"},Le={class:"time"},Re={class:"time"},Ye=B((()=>c("div",{class:"footPrintMap",id:"map"},null,-1))),He={class:"comment"},We={class:"commentHead"},qe={class:"leftCommentHead"},Ge=["src"],Xe={class:"commentHeadTexts"},Ke={class:"commentName"},Je={class:"commentTime"},Qe={class:"commentAction"},Ze={class:"commentScore"},et={class:"commentDescription"},tt={class:"commentPictures"},at=["src"],it={class:"notice"},st={class:"noticeTitleBar"},ot={class:"noticeTitleLeft"},lt={class:"noticeTitle"},rt={class:"noticeType"},nt=B((()=>c("div",{class:"noticeBadge"},null,-1))),dt={class:"noticeTime"},ct=["onClick"],mt={class:"noticeContent"},pt={class:"notice"},ut={class:"noticeTitleBar"},ht={class:"noticeTitleLeft"},gt={class:"noticeTitle"},ft={class:"noticeType"},vt={class:"noticeTime"},_t=["onClick"],yt={class:"noticeContent"};const wt=a(j,[["render",function(e,t,a,i,s,o){const v=l("navigation-bar"),_=l("n-timeline-item"),y=l("n-timeline"),w=l("n-modal"),b=l("n-tab-pane"),D=l("right-setting-view"),C=l("n-data-table"),P=l("n-tabs"),T=l("n-popconfirm"),x=l("n-pagination");return r(),n(u,null,[d(v),c("div",M,[c("div",O,[c("div",E,[c("div",F,[c("h1",U,m(e.$t("profile.personalCenter")),1),c("div",L,m(e.$t("profile.manageAllTheInformationYouNeedHere")),1)])]),c("div",R,[d(w,{show:i.showModal,"onUpdate:show":t[1]||(t[1]=e=>i.showModal=e)},{default:p((()=>[c("div",Y,[c("div",H,[c("div",W,m(e.$t("profile.travelName")),1),c("div",q,m(i.modalData.name),1),c("div",G,m(e.$t("homepage.searchPart.stet")),1),c("div",X,m(i.modalData.startTime+" - "+i.modalData.endTime),1),c("div",K,m(e.$t("profile.travelDetail")),1),c("div",{class:"attrValue link",onClick:t[0]||(t[0]=e=>this.$router.push("/trip/"+i.modalData.trip_id))},m(e.$t("profile.goToTravelDetail")),1)]),c("div",J,[c("div",Q,m(e.$t("profile.itinerary")),1),(r(!0),n(u,null,h(i.modalData.trip,(e=>(r(),g(y,{style:{"margin-left":"12px","margin-top":"12px"}},{default:p((()=>[d(_,{type:e.finished,title:e.title,content:e.content,time:"day "+e.day+" "+e.time_of_day+", "+e.time},null,8,["type","title","content","time"])])),_:2},1024)))),256))])])])),_:1},8,["show"]),d(P,{value:i.tabValue,"onUpdate:value":t[6]||(t[6]=e=>i.tabValue=e),class:"card-tabs",size:"large",animated:"",style:{margin:"0 -4px"},"pane-style":"padding-left: 4px; padding-right: 4px; box-sizing: border-box;"},{default:p((()=>[d(b,{name:"Dashboard",tab:"Dashboard","display-directive":"show:lazy"},{default:p((()=>[c("div",Z,[c("img",{src:s.basicInfo.avatar_url,class:"helloAvatar"},null,8,ee),c("div",te,m(e.$t("profile.hello",{expr:"Hello, "+s.basicInfo.username+". Which trip do you want to enjoy today?"})),1)]),(r(!0),n(u,null,h(s.recentTrips,(a=>(r(),n("div",ae,[c("div",ie,[c("div",se,m(a.name),1),c("div",{class:"recentTripMore",onClick:e=>this.$router.push("/trip/"+a.trip_id)},m(e.$t("hotLocation.more")),9,oe)]),c("div",le,[c("img",{class:"tripCover",src:a.cover_url},null,8,re),d(w,{show:e.showWeatherModel,"onUpdate:show":t[2]||(t[2]=t=>e.showWeatherModel=t)},null,8,["show"]),c("div",ne,[c("div",de,m(a.weather.city),1),c("div",ce,[c("div",me,m(e.$t("profile.temp",{expr:a.weather.temp.toFixed(0)+"℃"})),1),c("img",{src:a.weather.img_url,alt:"",class:"weatherImg"},null,8,pe)]),c("div",ue,[c("div",he,[c("div",ge,m(e.$t("profile.maxtemp",{expr:a.weather.max_temp.toFixed(0)+"℃"})),1),c("div",fe,m(e.$t("profile.max")),1)]),c("div",ve,[c("div",_e,m(e.$t("profile.avgtemp",{expr:a.weather.avg_temp.toFixed(0)+"℃"})),1),c("div",ye,m(e.$t("profile.avg")),1)]),c("div",we,[c("div",be,m(e.$t("profile.mintemp",{expr:a.weather.min_temp.toFixed(0)+"℃"})),1),c("div",De,m(e.$t("profile.min")),1)])])]),c("div",Ce,[c("div",Pe,m(e.$t("profile.flightInformation")),1),c("div",Te,m(a.flightInfo.status),1),c("div",xe,[c("div",ke,m(a.flightInfo.departure.airport_no),1),c("div",Ne,m(a.flightInfo.arrival.airport_no),1)]),c("div",Ie,[c("div",ze,m(a.flightInfo.departure.airport_loc),1),c("div",Se,m(a.flightInfo.arrival.airport_loc),1)]),c("div",$e,[c("div",Ae,m(e.$t("profile.takesOffFrom")),1),c("div",Ve,m(e.$t("profile.landingAt")),1)]),c("div",je,[c("div",Be,m(a.flightInfo.departure.airport_name),1),c("div",Me,m(a.flightInfo.arrival.airport_name),1)]),c("div",Oe,[c("div",Ee,m(a.flightInfo.departure.date),1),c("div",Fe,m(a.flightInfo.arrival.date),1)]),c("div",Ue,[c("div",Le,m(a.flightInfo.departure.time),1),c("div",Re,m(a.flightInfo.arrival.time),1)])])])])))),256)),Ye])),_:1}),d(b,{name:"Profile",tab:"Profile","display-directive":"show:lazy"},{default:p((()=>[d(D)])),_:1}),d(b,{name:"Orders",tab:"Orders","display-directive":"show:lazy"},{default:p((()=>[d(P,{value:i.orderType,"onUpdate:value":t[3]||(t[3]=e=>i.orderType=e),class:"card-tabs",size:"large",animated:"","pane-style":"padding-left: 4px; padding-right: 4px; box-sizing: border-box;"},{default:p((()=>[d(b,{name:"In Progress",tab:"In Progress"},{default:p((()=>[d(C,{columns:i.inProgressColumns,data:i.inProgressData},null,8,["columns","data"])])),_:1}),d(b,{name:"Completed",tab:"Completed"},{default:p((()=>[d(C,{columns:i.completedColumns,data:s.completedData},null,8,["columns","data"])])),_:1}),d(b,{name:"Cancelled",tab:"Cancelled"},{default:p((()=>[d(C,{columns:i.cancelledColumns,data:s.cancelledData},null,8,["columns","data"])])),_:1})])),_:1},8,["value"])])),_:1}),d(b,{name:"Your Comments",tab:"Your Comments","display-directive":"show:lazy"},{default:p((()=>[(r(!0),n(u,null,h(this.comments,(t=>(r(),n("div",He,[c("div",We,[c("div",qe,[c("img",{class:"commentAvatar",src:t.user_portrait},null,8,Ge),c("div",Xe,[c("div",Ke,m(t.user_name),1),c("div",Je,m(t.datetime),1)])]),d(T,{onPositiveClick:o.handleDeleteComment},{trigger:p((()=>[c("div",Qe,m(e.$t("profile.delete")),1)])),default:p((()=>[f(" "+m(e.$t("profile.areYouSureYouWantToDeleteYourComment")),1)])),_:1},8,["onPositiveClick"])]),c("div",Ze,m(t.score),1),c("p",et,m(t.des),1),c("div",tt,[(r(!0),n(u,null,h(t.pics,(e=>(r(),n("img",{class:"commentPicture",src:e},null,8,at)))),256))])])))),256)),d(x,{page:s.commentPage,"onUpdate:page":[t[4]||(t[4]=e=>s.commentPage=e),o.handleChangePage],"page-count":s.commentPages,"page-size":s.commentPageSize,"onUpdate:pageSize":[t[5]||(t[5]=e=>s.commentPageSize=e),o.handleChangePageSize],"show-size-picker":"","page-sizes":[10,20,30,40]},null,8,["page","page-count","page-size","onUpdate:pageSize","onUpdate:page"])])),_:1}),d(b,{name:"Notices",tab:"Notices","display-directive":"show:lazy"},{default:p((()=>[(r(!0),n(u,null,h(s.newNotices,(t=>(r(),n("div",it,[c("div",st,[c("div",ot,[c("div",lt,m(t.title),1),c("div",rt,m(t.type),1),nt,c("div",dt,m(t.time),1)]),c("div",{class:"noticeCheckBt",onClick:e=>o.handleCheck(t.id)},m(e.$t("profile.check")),9,ct)]),c("div",mt,m(t.content),1)])))),256)),(r(!0),n(u,null,h(s.oldNotices,(t=>(r(),n("div",pt,[c("div",ut,[c("div",ht,[c("div",gt,m(t.title),1),c("div",ft,m(t.type),1),c("div",vt,m(t.time),1)]),c("div",{class:"noticeCheckBt",onClick:e=>o.handleUncheck(t.id)},m(e.$t("profile.uncheck")),9,_t)]),c("div",yt,m(t.content),1)])))),256))])),_:1})])),_:1},8,["value"])])])])],64)}],["__scopeId","data-v-a7885bb9"]]);export{wt as default};
